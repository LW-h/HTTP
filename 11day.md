## Web的攻击技术

#### 针对Web的攻击技术

> HTTP协议本身不会几乎不会成为攻击对象。应用在HTTP协议的服务器和客户端，以及运行在服务器上的Web应用等资源才是攻击目标。从整体上看，HTTP就是一个通用的单纯协议机制。因此它具备较多优势，但是在安全性方面呈现劣势

在客户端可篡改请求

> 在Web应用中，从浏览器那接收到的HTTP请求的全部内容，都可以在客户端自由地变更、篡改。在HTTP请求报文内加载攻击代码，就能发起对Web应用的攻击。通过URL查询字段或表单、HTTP首部、Cookie等途径把攻击代码传入，若这时Web应用存在安全漏洞，那内存信息就会遭到窃取，或被攻击者拿到管理权限。攻击模式有一下两种：

+ 主动攻击
+ 被动攻击
+ 以服务器为目标的主动攻击：主动攻击(active attack)是指攻击者通过直接访问Web应用，把攻击代码传入的攻击模式。主动攻击的代表是SQL注入攻击和OS命令注入攻击
+ 以服务器为目标的被动攻击：被动攻击(passive attack)是指利用圈套策略执行攻击代码的攻击模式。攻击者不直接对目标Web应用访问发起攻击。主要步骤如下：

  + 攻击者诱使用户触发已设置好的陷阱，而陷阱会启动发送嵌入攻击代码的HTTP请求
  + 当用户不知不觉中招之后，用户的浏览器或邮件客户端就会触发这个陷阱
  + 中招后的用户浏览器会把含有攻击代码的HTTP请求发送给作为攻击目标的Web应用，运行攻击代码
  + 执行完攻击代码，存在安全漏洞的Web应用会成为攻击者的跳板，可能导致用户所持的Cookie等个人信息泄露，登录状态的用户权限遭受恶意滥用
  + 被动攻击模式具有代表的是：跨站脚本攻击和跨站求情伪造

> 利用被动攻击，可发起对原本从互联网上无法直接访问的企业内网等网络攻击。

因输出值转义不完全引发的安全漏洞

实施Web安全策略大致可分两部分：

+ 客户端验证
+ Web应用端验证

  + 输入值验证
  + 输出值转义

> 多数情况采用JavaScript在客户端验证数据。不适合将JavaScript验证作为安全的防范对策。保留客户端验证只是为了尽早地辨识输入错误，起到提高UI体验的作用。Web应用端的输入验证按Web应用内的处理则有可能被误解为是具有攻击性意义的代码。输入值检验通常是检查是否符合系统业务逻辑的数值或检查字符编码等预防策略。从数据库或文件系统、HTML、邮件等输出Web应用处理的数据之际，针对输出做转义处理是一项至关重要的安全策略。当输出值转义不完全时，会因触发攻击者出入的代码，而给输出对象带来损害

跨站脚本攻击

> 跨站脚本攻击(Cross-Site-Scripting,XSS)是指通过存在安全漏洞的Web网站注册用户的浏览器内运行非法的HTML标签或JavaScript进行的一种攻击。

可能造成的影响：

+ 利用虚假输入表单骗取用户个人信息
+ 利用脚本窃取用户的Cookie值，被害者在不知道的情况下，帮助攻击者发送恶意请求
+ 显示伪造的文章或图片

 SQL注入：

> SQL注入(SQL Injection)是指针对Web应用使用的数据库，通过运行非法的SQL而产生的攻击。SQL造成的影响如下：

+ 非法查看或篡改数据库内的数据
+ 规避认证
+ 执行和数据库服务器业务关联的程序...

> SQL是用来操作关系型数据库管理系统(Relational DataBase Management System.RDBMS)的数据库语言，可进行操作数据或定义数据等。著名的数据库有Oracle Database、Microsoft SQL Server、IBM DB2、MySQL、PostgreSQL...这些数据库系统都可以把SQL作为数据库语言使用。使用数据库的Web应用，通过某种方法将SQL语句传给RDBMS，再把返回的结果灵活的使用在Web应用中

OS命令注入攻击

> OS命令注入攻击(OS Command Injection)是指通过Web应用，执行非法的操作系统命令达到攻击的目的。只要在能调用Shell函数的地方就有存在的被攻击的风险。OS命令注入攻击可以向Shell发送命令，让Windows或Linux操作系统的命令行启动程序。也就是说，通过OS注入可以执行OS上安装着的各种程序


HTTP首部注入攻击

> HTTP首部攻击(HTTP Header Injection)是指攻击者通过在响应首部字段内插入换行，添加任意响应首部或主体的一种攻击。向首部内添加内容的攻击称为HTTP响应阶段攻击(HTTP Response Spliting Attack).造成的影响如下：

+ 设置任何Cookie信息
+ 重定向至任意URL
+ 显示任意的主体(HTTP响应截断攻击)

邮件首部注入攻击

> 邮箱首部注入(Mail Header Injection)是指Web应用中的邮件发送功能，攻击者通过向邮件首部To或Subject内任意添加非法内容发起的攻击。利用存在安全漏洞的Web网站，可对任意邮件地址发送广告邮件或病毒邮件

目录遍历攻击

> 目录遍历(Directory Traversal)攻击指在对本无意公开的文件目录，通过非法截断其目录路径后，达成访问目的的一种攻击。通过Web应用对文件处理操作时，在由外部指定文件名的处理存在疏漏的情况下，用户可以使用../等相对路径定位到/etc/passed等绝对路径上，因此服务器上的所有文件和目录都可以被访问到。输出转义固然重要，但更应该关闭指定对任意文件名的访问权限

远程文件包含漏洞

> 远程文件包含漏洞(Remote File Inclusion)是指当部分脚本内容需要从其它文件读入时，攻击者利用指定外部服务器的URL充当依赖文件，让脚本读取之后，就可以运行任意脚本的一种攻击。这主要PHP存在的漏洞，对PHP的include或require来说，这是一种可通过设定，指定外部服务器的URI作为文件名的功能。PHP5.2.0之后默认设定次功能无效

因设置或设计上的缺陷引发的安全漏洞

> 因设置或设计上的缺陷引发的安全漏洞是指，错误设置Web服务器，或是由设计上的一些问题引发的安全漏洞

强制浏览

> 强制浏览(Forced Browsing)安全漏洞是指，从安置在Web服务器的公开目录下的文件中，浏览那些原本非自愿公开的文件。造成的影响如下：

+ 泄露顾客的个人信息等重要情报
+ 泄露原本需要具有访问权限的用户才可以查阅的信息内容
+ 泄露未外连到外界的文件

不正确的错误信息处理

> 不正确的错误消息处理(Error Handling Vulnerability)的安全漏洞是指，Web应用的错误消息内容包含对攻击者有用的信息。主要错误如下：

+ Web应用抛出的错误信息
+ 数据库等系统抛出的错误信息 

> 系统抛出的错误主要集中在一下几个方面：

+ PHP或ASP等脚本错误
+ 数据库或中间件的错误
+ Web服务器的错误

> 各系统应对详细的错误信息进行抑制设定，或使用自定义错误信息，以避免某些错误信息给攻击者启发

开放重定向

> 开放重定向(open Redirect)是一种对指定的任意URL作重定向跳转的功能。而相关的漏洞是指，假如指定的重定向URL到某个具有恶意的Web网站，那么用户就会被诱导至那个Web网站

因会话管理疏忽引发的安全漏洞

> 会话管理是用来管理用户状态的必备功能，但是如果在会话管理上有所疏忽，就会导致用户的认证状态被窃取等后果

会话劫持

> 会话劫持(Session Hijack)是指攻击者通过某种手段拿到了用户的会话ID，并非法使用次会话ID伪装成用户，达到攻击的目的。下面列举了几种攻击者可获取会话ID：

+ 通过非正规的生成方法推测会话ID
+ 通过窃听或XSS攻击盗取会话ID
+ 通过会话固定攻击(Session Fixation)强行获取会话ID

跨站请求伪造

> 跨站请求伪造(Cross-site Request Forgeries,CSRF)攻击是指攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态更新。可能造成的影响如下：

+ 利用已通过认证的用户权限更新设定信息
+ 利用已通过认证的用户进行一些非法操作

密码破解

> 密码破解攻击(Password Cracking)既算出密码，突破认证。密码破解的手段有如下：

+ 通过网络的密码试错
+ 对已加密密码的破解

> 网络试错的手段如下

+ 穷举法
+ 字典攻击

> 破解已经加密的密码手段有如下：

+ 通过穷举法、字典攻击进行类推【尝试调用相同的散列函数加密候选密码，然后把计算出来散列值与目标匹配，类推出密码】
+ 彩虹表【Rainbow Table是由明文密码及与之对应的散列值构成的一张数据库，是一种通过事先制作庞大的彩虹表，可在穷举法、字典攻击等实际破解中缩短消耗时间。从彩虹表内搜索散列值就可以推导出对应的明文密码.】[Free Rainbow Tables](http://www.freerainbowtables.com/en/tables2/)
+ 拿到秘钥【使用共享秘钥加密方式，如果可通过某种手段拿到加密使用的秘钥，也就可以对密码数据破解】
+ 加密算法本身漏洞【对已经广泛使用的加密算法，找到漏洞困难极大。而对Web应用开发者独立实现的加密算法，尚未经过充分的验证，还是可能存在漏洞】

点击劫持

> 点击劫持(Clickjacking)是指利用透明的按钮或链接做成陷阱，覆盖在Web页面上。然后诱使用户在不知情的情况下，点击那个链接访问内容一种攻击手段。也称为页面伪装(UI Redressing)

Dos攻击

> Dos攻击(Denial of Service attack)是一种让运行中服务呈停止状态的攻击。也叫做服务停止攻击或拒绝服务攻击，Dos目标可为一切可访问的服务或设备，多台计算机发起的Dos攻击称为DDos攻击(Distributed Denial of Service attack).Dos主要有一下攻击方式：

+ 集中利用访问请求造成资源加载，资源用尽的同时，实际上服务也就呈停止状态
+ 通过攻击安全漏洞使服务停止

后门程序

> 后门程序(Backdoor)是指开发设置的隐藏入口，可不按正常步骤使用受限功能。可以使用原本受限制的功能。主要有如下几种：

+ 开发阶段作为Debug调用的后门程序
+ 开发者为了自身利益植入的后门程序
+ 攻击者通过某种方法设置的后门程序

> 可通过监视进程和通信的状态发现被植入的后门程序，但在Web应用中的后门程序，由于与正常功能相差不是很大，通常很难发现